<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
background-image:url("background2.png");
}
/* From Uiverse.io by LightAndy1 */ 
.signin {
  float: right;
  max-width: 320px;
  display: flex;
  padding: 0.5rem 1.4rem;
  font-size: 0.875rem;
  line-height: 1.25rem;
  font-weight: 700;
  text-align: center;
  font-family: "Montserrat", sans-serif;
  vertical-align: middle;
  align-items: center;
  border-radius: 0.5rem;
  border: 1px solid rgba(255, 255, 255, 0.25);
  gap: 0.75rem;
  color: #c4d2dc;
  background-color: #19242b;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0, 0.87, 0.12, 1);
}

.signin:hover {
  transform: scale(1.025);
}

.signin:active {
  transform: scale(0.975);
}

button svg {
  height: 24px;
  width: auto;
}
.button{
margin-right:40%;
margin-top:25%;
}
@media(max-width:480px){
.button{
margin-left:13%;
margin-top:45%;
}
}
.btn{
  top:4px;
  left:4px;
  position:absolute;
  z-index:1200;
  }
</style>
<title>Google log in or sign up</title>
</head>
<body>
<a href = "index.html"><img src = "icon1.png" style = "height:40px"></a>
<!-- From Uiverse.io by LightAndy1 --> 
<div class = "button">
<button class="signin" onclick = "login()">
  <svg
    viewBox="0 0 256 262"
    preserveAspectRatio="xMidYMid"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"
      fill="#4285F4"
    ></path>
    <path
      d="M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"
      fill="#34A853"
    ></path>
    <path
      d="M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782"
      fill="#FBBC05"
    ></path>
    <path
      d="M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"
      fill="#EB4335"
    ></path>
  </svg>
  Sign up/ log in/ continue with google
</button>
</div>
<script>
let caution = `----------------------------Caution------------------------------
                 
আমরা দু-ভাবে এ্যাকাউন্ট খোলার মাধ্যম করেছি।
১. কাস্টমাইজ এ্যাকাউন্ট

যেখানে আপনি এ্যাডমিন/মডারেটরদের সাথে যোগাযোগ করে
নিজের মতো করে এ্যাকাউন্ট তৈরি করে নিতে পারেন।

২. গুগল দিয়ে তৈরি করা এ্যাকাউন্ট

এক্ষেত্রে কোন এ্যাডমিন/মডারেটরদের সাথে যোগাযোগ করার প্রয়োজন নেই।
আপনি নিজেই "ok"-তে চাপ দিয়ে “Sign up/ log in/ continue with googl” বাটনে চাপ দিয়ে
গুগলের মাধ্যমে এ্যাকাউন্ট তৈরি করে ফেলতে পারবেন।
তবে গুগল দিয়ে এ্যাকাউন্ট খুললে সর্বদা এ্যাকাউন্টে প্রবেশ করতে হলে
আপনাকে গুগলের মাধ্যমেই লগইন করতে হবে।`;

alert(caution);
</script>
<script type="module">

// Firebase Import
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getAuth,
  GoogleAuthProvider,
  signInWithRedirect,
  getRedirectResult,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import {
  getFirestore,
  doc,
  getDoc,
  setDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDjEgk5EHgQD5HQJxEvHOzFwVyr9ZLEZBY",
  authDomain: "verifyprojectss.firebaseapp.com",
  projectId: "verifyprojectss",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

function generateAccountId() {
  return Math.floor(100000 + Math.random() * 900000).toString();
}

window.login = async function () {
  await signInWithRedirect(auth, provider);
};

getRedirectResult(auth).catch(console.error);

onAuthStateChanged(auth, async (user) => {
  if (user) {
    const userRef = doc(db, "users", user.uid);
    const userSnap = await getDoc(userRef);

    if (!userSnap.exists()) {
      await setDoc(userRef, {
        name: user.displayName,
        email: user.email,
        accountId: generateAccountId(),
        balance: 5,
        createdAt: new Date()
      });
    }

    window.location.href = "user.html";
  }
});

</script>


</body>
</html>
